{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/Qwen3.5-35B-Bridge-Agent/agents/client-qa-lead/skill-schema.json",
  "title": "Client QA Lead Skill Configuration Schema",
  "description": "JSON Schema для валидации YAML-конфигурации Client QA Lead агента (LangGraph/AutoGen compatible)",
  "$defs": {
    "agent_metadata": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9_]*$",
          "description": "Идентификатор агента (snake_case, начинается с буквы)"
        },
        "title": {
          "type": "string",
          "minLength": 1,
          "description": "Человекочитаемое название роли"
        },
        "version": {
          "$ref": "#/definitions/version_string",
          "description": "Версия конфигурации (semantic versioning)"
        },
        "department": {
          "type": "string",
          "enum": [
            "product",
            "engineering",
            "design",
            "qa",
            "devops",
            "cto",
            "hr"
          ],
          "description": "Департамент, к которому относится агент"
        },
        "access": {
          "$ref": "#/definitions/access_level",
          "default": "read",
          "description": "Уровень доступа к файлам проекта"
        }
      },
      "required": [
        "name",
        "title",
        "version",
        "department"
      ],
      "additionalProperties": false
    },
    "triggers_config": {
      "type": "object",
      "properties": {
        "keywords": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/trigger_keyword"
          },
          "minItems": 1,
          "description": "Ключевые слова для активации агента"
        },
        "domains": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/domain_name"
          },
          "minItems": 1,
          "description": "Домены экспертизы агента"
        }
      },
      "required": [
        "keywords",
        "domains"
      ],
      "additionalProperties": false
    },
    "organization_config": {
      "type": "object",
      "properties": {
        "reports_to": {
          "$ref": "#/definitions/agent_role",
          "description": "Роль, перед которой отчитывается агент"
        },
        "coordinates_with": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/collaboration_config"
          },
          "description": "С кем координируется агент"
        }
      },
      "required": [
        "reports_to",
        "coordinates_with"
      ],
      "additionalProperties": false
    },
    "collaboration_config": {
      "type": "object",
      "properties": {
        "agent_type": {
          "$ref": "#/definitions/agent_role",
          "description": "Тип агента для координации"
        },
        "purpose": {
          "type": "string",
          "minLength": 1,
          "description": "Цель взаимодействия"
        }
      },
      "required": [
        "agent_type",
        "purpose"
      ],
      "additionalProperties": false
    },
    "responsibilities_config": {
      "type": "object",
      "patternProperties": {
        "^[a-z][a-z0-9_]*$": {
          "$ref": "#/definitions/responsibility_block"
        }
      },
      "additionalProperties": false
    },
    "responsibility_block": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Описание обязанности"
        },
        "core_tasks": {
          "$ref": "#/definitions/core_task_array",
          "description": "Список задач в рамках обязанности"
        }
      },
      "required": [
        "description",
        "core_tasks"
      ],
      "additionalProperties": false
    },
    "task_item": {
      "$ref": "#/definitions/core_task_object"
    },
    "core_task_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/core_task_object"
      }
    },
    "core_task_object": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Идентификатор задачи"
        },
        "action": {
          "type": "string",
          "minLength": 1,
          "description": "Действие по задаче"
        }
      },
      "required": [
        "name",
        "action"
      ],
      "additionalProperties": false
    },
    "workspace_config": {
      "$ref": "#/definitions/workspace_object"
    },
    "workspace_object": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "minLength": 1,
          "description": "Путь к рабочей директории агента"
        },
        "structure": {
          "$ref": "#/definitions/workspace_structure_object"
        }
      },
      "required": [
        "path",
        "structure"
      ],
      "additionalProperties": false
    },
    "workspace_structure_object": {
      "type": "object",
      "patternProperties": {
        "^[a-z][a-z0-9_]*$": {
          "$ref": "#/definitions/workspace_directory"
        }
      },
      "additionalProperties": false
    },
    "workspace_directory": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Описание директории"
        },
        "formats": {
          "$ref": "#/definitions/format_array",
          "description": "Форматы файлов в директории"
        }
      },
      "required": [
        "description"
      ],
      "additionalProperties": false
    },
    "project_context_config": {
      "$ref": "#/definitions/project_context_object"
    },
    "test_directories_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/test_directory"
      }
    },
    "test_directory": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Название директории тестов"
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Описание типа тестов"
        },
        "focus_areas": {
          "$ref": "#/definitions/focus_area_array",
          "description": "Области фокуса для тестирования"
        }
      },
      "required": [
        "name",
        "description"
      ],
      "additionalProperties": false
    },
    "focus_area_array": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "project_context_object": {
      "type": "object",
      "properties": {
        "app_name": {
          "type": "string",
          "minLength": 1,
          "description": "Название приложения"
        },
        "platform": {
          "type": "string",
          "minLength": 1,
          "description": "Платформа разработки"
        },
        "technologies": {
          "$ref": "#/definitions/technology_array",
          "description": "Технологии, используемые в проекте"
        },
        "test_directories": {
          "$ref": "#/definitions/test_directories_array",
          "description": "Директории с тестами проекта"
        },
        "integrations": {
          "$ref": "#/definitions/integration_array",
          "description": "Интеграции с внешними сервисами"
        }
      },
      "required": [
        "app_name",
        "platform",
        "technologies"
      ],
      "additionalProperties": false
    },
    "constraint_config": {
      "$ref": "#/definitions/constraint_object"
    },
    "hard_constraint_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/hard_constraint"
      }
    },
    "soft_constraint_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/soft_constraint"
      }
    },
    "constraint_object": {
      "type": "object",
      "properties": {
        "hard_constraints": {
          "$ref": "#/definitions/hard_constraint_array",
          "description": "Жесткие ограничения (must not violate)"
        },
        "soft_constraints": {
          "$ref": "#/definitions/soft_constraint_array",
          "description": "Мягкие ограничения (should follow)"
        }
      },
      "required": [
        "hard_constraints"
      ],
      "additionalProperties": false
    },
    "success_metric_config": {
      "$ref": "#/definitions/success_metric_object"
    },
    "quantitative_metrics_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/quantitative_metric"
      }
    },
    "qualitative_metrics_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/qualitative_metric"
      }
    },
    "success_metric_object": {
      "type": "object",
      "properties": {
        "quantitative": {
          "$ref": "#/definitions/quantitative_metrics_array",
          "description": "Количественные метрики (measurable)"
        },
        "qualitative": {
          "$ref": "#/definitions/qualitative_metrics_array",
          "description": "Качественные метрики (assessed)"
        }
      },
      "required": [
        "quantitative"
      ],
      "additionalProperties": false
    },
    "workflow_examples_config": {
      "$ref": "#/definitions/workflow_examples_array"
    },
    "workflow_example_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/workflow_example_object"
      }
    },
    "algorithm_steps_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/algorithm_step_object"
      }
    },
    "workflow_example_object": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Название workflow примера"
        },
        "trigger_phrase": {
          "type": "string",
          "minLength": 1,
          "description": "Фраза, которая активирует этот сценарий"
        },
        "algorithm": {
          "$ref": "#/definitions/algorithm_object"
        }
      },
      "required": [
        "name",
        "trigger_phrase",
        "algorithm"
      ],
      "additionalProperties": false
    },
    "algorithm_object": {
      "type": "object",
      "properties": {
        "steps": {
          "$ref": "#/definitions/algorithm_steps_array",
          "description": "Шаги алгоритма выполнения"
        }
      },
      "required": [
        "steps"
      ],
      "additionalProperties": false
    },
    "algorithm_step_object": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1,
          "description": "Идентификатор шага"
        },
        "action": {
          "type": "string",
          "minLength": 1,
          "description": "Действие по шагу"
        },
        "details": {
          "$ref": "#/definitions/detail_array",
          "description": "Детали выполнения действия"
        }
      },
      "required": [
        "id",
        "action"
      ],
      "additionalProperties": false
    },
    "detail_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/detail_item"
      }
    },
    "detail_item": {
      "oneOf": [
        {
          "type": "string",
          "minLength": 1
        },
        {
          "$ref": "#/definitions/detail_object"
        }
      ]
    },
    "detail_object": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "value": {}
      },
      "required": [
        "name"
      ]
    },
    "version_history_config": {
      "$ref": "#/definitions/version_history_object"
    },
    "changelog_entry_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/changelog_entry"
      }
    },
    "version_history_object": {
      "type": "object",
      "properties": {
        "current_version": {
          "$ref": "#/definitions/version_string"
        },
        "created_at": {
          "$ref": "#/definitions/date_pattern"
        },
        "last_modified": {
          "$ref": "#/definitions/date_pattern"
        },
        "changelog": {
          "$ref": "#/definitions/changelog_entry_array",
          "description": "История изменений конфигурации"
        }
      },
      "required": [
        "current_version",
        "created_at",
        "last_modified"
      ],
      "additionalProperties": false
    },
    "changelog_entry": {
      "$ref": "#/definitions/changelog_object"
    },
    "changelog_object": {
      "type": "object",
      "properties": {
        "version": {
          "$ref": "#/definitions/version_string"
        },
        "date": {
          "$ref": "#/definitions/date_pattern"
        },
        "changes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      },
      "required": [
        "version",
        "date",
        "changes"
      ],
      "additionalProperties": false
    }
  },
  "definitions": {
    "access_level": {
      "type": "string",
      "enum": [
        "read",
        "write",
        "full"
      ],
      "default": "read"
    },
    "trigger_keyword": {
      "type": "string",
      "minLength": 1,
      "maxLength": 50
    },
    "domain_name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 50
    },
    "agent_role": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*$"
    },
    "severity_level": {
      "type": "string",
      "enum": [
        "CRITICAL",
        "HIGH",
        "MEDIUM",
        "LOW"
      ]
    },
    "target_value_pattern": {
      "oneOf": [
        {
          "type": "string",
          "pattern": "^\\d+%$",
          "description": "Процентное значение (например, '90%')"
        },
        {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      ]
    },
    "duration_pattern": {
      "type": "string",
      "pattern": "^\\d+ (неделя|недели|месяц|месяца|месяцев|день|дня|дней)$"
    },
    "version_string": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "date_pattern": {
      "type": "string",
      "format": "date",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },
    "task_array": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/task_item"
      }
    },
    "deliverable_array": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "format_array": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "technology_array": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "integration_array": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "hard_constraint": {
      "$ref": "#/definitions/constraint_base"
    },
    "soft_constraint": {
      "$ref": "#/definitions/constraint_base"
    },
    "constraint_base": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z]\\d+$",
          "description": "Идентификатор (h1, h2, s1, s2, ...)",
          "example": "h1"
        },
        "rule": {
          "type": "string",
          "minLength": 1,
          "description": "Формулировка правила"
        },
        "severity": {
          "$ref": "#/definitions/severity_level",
          "default": "CRITICAL"
        },
        "enforcement": {
          "type": "string",
          "minLength": 1,
          "description": "Механизм enforcement правила"
        }
      },
      "required": [
        "id",
        "rule",
        "severity",
        "enforcement"
      ],
      "additionalProperties": false
    },
    "quantitative_metric": {
      "$ref": "#/definitions/metric_base"
    },
    "qualitative_metric": {
      "$ref": "#/definitions/metric_base"
    },
    "metric_base": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Название метрики"
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Описание метрики"
        },
        "target_value": {
          "$ref": "#/definitions/target_value_pattern"
        },
        "measurement_method": {
          "type": "string",
          "minLength": 1,
          "description": "Как измеряется метрика"
        }
      },
      "required": [
        "name",
        "description",
        "target_value",
        "measurement_method"
      ],
      "additionalProperties": false
    }
  },
  "$ref": "#/definitions/skill_config_root"
}
