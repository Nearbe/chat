# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞: Chat

iOS-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ SwiftUI —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π LLM (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å LM Studio / Ollama).

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

- **–¢–∏–ø**: –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è iOS
- **–Ø–∑—ã–∫**: Swift 6.0
- **UI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫**: SwiftUI
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: SwiftData
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: MVVM + SwiftData + Apple Keychain
- **–û—Å–Ω–æ–≤–Ω–∞—è IDE**: JetBrains IntelliJ IDEA (Xcode ‚Äî –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π)
- **–Ø–∑—ã–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: –†—É—Å—Å–∫–∏–π

## –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ             | –§–∞–π–ª                                           |
|------------------------|------------------------------------------------|
| –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `App/ChatApp.swift`                            |
| –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω          | `Features/Chat/Views/ChatView.swift`           |
| –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | `Features/Chat/ViewModels/ChatViewModel.swift` |
| –°–µ—Ç–µ–≤–æ–π —à–ª—é–∑           | `Services/Network/NetworkService.swift`        |
| –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å        | `Data/PersistenceController.swift`             |

## –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è         | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                             |
|-------------------|----------------------------------------|
| UI                | SwiftUI                                |
| Data              | SwiftData                              |
| DI                | Factory                                |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ       | Pulse                                  |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ      | Swift Testing, XCTest, SnapshotTesting |
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞    | XcodeGen, SwiftGen                     |
| –õ–∏–Ω—Ç–∏–Ω–≥           | SwiftLint                              |
| –¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ | iOS 26.2                               |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Chat/
‚îú‚îÄ‚îÄ App/                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (ChatApp.swift)
‚îú‚îÄ‚îÄ Features/               # –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ Chat/              # –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ (Views, ViewModels, Components)
‚îÇ   ‚îú‚îÄ‚îÄ History/           # –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ Settings/          # –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ   ‚îî‚îÄ‚îÄ Common/            # –û–±—â–∏–µ UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ Core/                  # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ Data/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SwiftData (PersistenceController)
‚îú‚îÄ‚îÄ Design/                # –î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ (Colors, Spacing, Typography)
‚îú‚îÄ‚îÄ Models/                # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ API/               # –ú–æ–¥–µ–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ API
‚îÇ   ‚îú‚îÄ‚îÄ LMStudio/          # –ú–æ–¥–µ–ª–∏ LM Studio
‚îÇ   ‚îî‚îÄ‚îÄ *.swift            # –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (Message, ChatSession –∏ –¥—Ä.)
‚îú‚îÄ‚îÄ Services/              # –°–µ—Ä–≤–∏—Å—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ Auth/              # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Keychain)
‚îÇ   ‚îú‚îÄ‚îÄ Chat/              # –°–µ—Ä–≤–∏—Å —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Network/           # HTTP-–∫–ª–∏–µ–Ω—Ç, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ Errors/            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ Resources/             # –†–µ—Å—É—Ä—Å—ã, Info.plist, entitlements
‚îú‚îÄ‚îÄ ChatTests/             # Unit-—Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ ChatUITests/           # UI-—Ç–µ—Å—Ç—ã (Page Object Model)
‚îú‚îÄ‚îÄ Tools/Scripts/         # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞ Swift
‚îî‚îÄ‚îÄ Docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö API
```

## API URL (LM Studio v1)

–ë–∞–∑–æ–≤—ã–π URL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `http://192.168.1.91:64721`

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç                          | –û–ø–∏—Å–∞–Ω–∏–µ                          |
|-------|-----------------------------------|-----------------------------------|
| GET   | `/api/v1/models`                  | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π |
| POST  | `/api/v1/models/load`             | –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å –≤ –ø–∞–º—è—Ç—å         |
| POST  | `/api/v1/models/unload`           | –í—ã–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å –∏–∑ –ø–∞–º—è—Ç–∏        |
| POST  | `/api/v1/models/download`         | –°–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è     |
| GET   | `/api/v1/models/download/{jobId}` | –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è        |
| POST  | `/api/v1/chat`                    | –°—Ç—Ä–∏–º–∏–Ω–≥ —á–∞—Ç-–∫–æ–º–ø–ª–∏—à–µ–Ω–∞ (SSE)     |

## –≠–∫—Ä–∞–Ω—ã –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ—É—Ç—ã (NavigationStack)

| –ü—É—Ç—å            | –≠–∫—Ä–∞–Ω (View)  | ViewModel       | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|-----------------|---------------|-----------------|---------------------------|
| `/`             | `ChatView`    | `ChatViewModel` | –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —á–∞—Ç–∞        |
| `/history`      | `HistoryView` | ‚Äî               | –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤ (–º–æ–¥–∞–ª—å–Ω—ã–π) |
| `/model-picker` | `ModelPicker` | ‚Äî               | –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ (–º–æ–¥–∞–ª—å–Ω—ã–π)  |

### –°—Ö–µ–º–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

```
ChatView (root)
‚îú‚îÄ‚îÄ tokenRequiredView (–µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
‚îÇ   ‚îî‚îÄ‚îÄ ShieldView (3D —â–∏—Ç –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ–∫–µ–Ω–∞)
‚îú‚îÄ‚îÄ emptyStateView (–µ—Å–ª–∏ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π)
‚îú‚îÄ‚îÄ ChatMessagesView (—Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π)
‚îú‚îÄ‚îÄ MessageInputView (–ø–æ–ª–µ –≤–≤–æ–¥–∞)
‚îÇ
‚îú‚îÄ‚îÄ HistoryView (sheet)
‚îÇ   ‚îî‚îÄ‚îÄ SessionRowView (—Å—Ç—Ä–æ–∫–∏ —Å–µ—Å—Å–∏–π)
‚îÇ
‚îú‚îÄ‚îÄ ModelPicker (sheet)
‚îÇ   ‚îî‚îÄ‚îÄ ModelRowView (—Å—Ç—Ä–æ–∫–∏ –º–æ–¥–µ–ª–µ–π)
‚îÇ
‚îú‚îÄ‚îÄ ConsoleView (sheet) ‚Äî Pulse –æ—Ç–ª–∞–¥–∫–∞
‚îî‚îÄ‚îÄ ShareSheet (sheet) ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –≤ Markdown
```

## –ú–æ–¥–µ–ª–∏ –∏ —Å—É—â–Ω–æ—Å—Ç–∏

### –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (SwiftData)

| –ú–æ–¥–µ–ª—å        | –§–∞–π–ª                       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                 | –°–≤—è–∑–∏                                                          |
|---------------|----------------------------|----------------------------|----------------------------------------------------------------|
| `Message`     | `Models/Message.swift`     | –û—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ | –ü—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç `ChatSession` (relationship), —Å–æ–¥–µ—Ä–∂–∏—Ç `sessionId` |
| `ChatSession` | `Models/ChatSession.swift` | –°–µ—Å—Å–∏—è —á–∞—Ç–∞ (–∏—Å—Ç–æ—Ä–∏—è)      | –°–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ `Message` (–∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)                 |

**–°–≤—è–∑–∏ –º–µ–∂–¥—É SwiftData –º–æ–¥–µ–ª—è–º–∏:**

```
ChatSession (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< Message (N)
     ‚îÇ
     ‚îú‚îÄ‚îÄ id: UUID
     ‚îú‚îÄ‚îÄ title: String
     ‚îú‚îÄ‚îÄ modelName: String
     ‚îú‚îÄ‚îÄ messages: [Message] @Relationship(deleteRule: .cascade)
     ‚îÇ
     ‚îî‚îÄ‚îÄ sortedMessages: [Message] (computed)
```

### –ú–æ–¥–µ–ª–∏ API (LM Studio)

| –ú–æ–¥–µ–ª—å                 | –§–∞–π–ª                                         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                 |
|------------------------|----------------------------------------------|--------------------------------------------|
| `LMModelsResponse`     | `Models/LMModelsResponse.swift`              | –û—Ç–≤–µ—Ç API —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π                   |
| `LMChatRequest`        | `Models/LMStudio/LMChatRequest.swift`        | –ó–∞–ø—Ä–æ—Å —á–∞—Ç–∞ (messages, model, temperature) |
| `LMChatResponse`       | `Models/LMStudio/LMChatResponse.swift`       | –û—Ç–≤–µ—Ç —á–∞—Ç–∞ (output, stats, responseId)     |
| `LMOutputItem`         | `Models/LMStudio/LMChatResponse.swift`       | –≠–ª–µ–º–µ–Ω—Ç –≤—ã–≤–æ–¥–∞: message/toolCall/reasoning |
| `LMMessageContent`     | `Models/LMStudio/LMMessageContent.swift`     | –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ                        |
| `LMToolCall`           | `Models/LMStudio/LMToolCall.swift`           | –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞                          |
| `LMReasoningContent`   | `Models/LMStudio/LMReasoningContent.swift`   | –†–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ (chain of thought)      |
| `LMStats`              | `Models/LMStudio/LMStats.swift`              | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏                       |
| `LMSEvent`             | `Models/LMStudio/LMSEvent.swift`             | SSE —Å–æ–±—ã—Ç–∏–µ —Å—Ç—Ä–∏–º–∞                         |
| `LMStreamChunk`        | `Models/LMStudio/LMStreamChunk.swift`        | –ß–∞–Ω–∫ —Å—Ç—Ä–∏–º-–¥–∞–Ω–Ω—ã—Ö                          |
| `LMDoneEvent`          | `Models/LMStudio/LMDoneEvent.swift`          | –§–∏–Ω–∞–ª—å–Ω–æ–µ SSE —Å–æ–±—ã—Ç–∏–µ                      |
| `LMError`              | `Models/LMStudio/LMError.swift`              | –û—à–∏–±–∫–∞ –æ—Ç API                              |
| `LMModelLoadRequest`   | `Models/LMStudio/LMModelLoadRequest.swift`   | –ó–∞–ø—Ä–æ—Å –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏                     |
| `LMModelLoadResponse`  | `Models/LMStudio/LMModelLoadResponse.swift`  | –û—Ç–≤–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏                      |
| `LMModelUnloadRequest` | `Models/LMStudio/LMModelUnloadRequest.swift` | –ó–∞–ø—Ä–æ—Å –≤—ã–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏                     |
| `LMDownloadRequest`    | `Models/LMStudio/LMDownloadRequest.swift`    | –ó–∞–ø—Ä–æ—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏                   |
| `LMDownloadResponse`   | `Models/LMStudio/LMDownloadResponse.swift`   | –û—Ç–≤–µ—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏—è                           |
| `LMDownloadStatus`     | `Models/LMStudio/LMDownloadStatus.swift`     | –°—Ç–∞—Ç—É—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è                          |
| `LMProviderInfo`       | `Models/LMStudio/LMProviderInfo.swift`       | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ                    |
| `LMInput`              | `Models/LMStudio/LMInput.swift`              | –í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ                            |
| `LMMessageContent`     | `Models/LMStudio/LMMessageContent.swift`     | –ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è                          |
| `LMModelLoadConfig`    | `Models/LMStudio/LMModelLoadConfig.swift`    | –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏                     |
| `LMToolCallMetadata`   | `Models/LMStudio/LMToolCallMetadata.swift`   | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ tool call                       |
| `LMInvalidToolCall`    | `Models/LMStudio/LMInvalidToolCall.swift`    | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞             |

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏

| –ú–æ–¥–µ–ª—å              | –§–∞–π–ª                             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                              |
|---------------------|----------------------------------|-----------------------------------------|
| `ModelInfo`         | `Models/ModelInfo.swift`         | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç—É–ø–Ω–æ–π –º–æ–¥–µ–ª–∏           |
| `ModelCapabilities` | `Models/ModelCapabilities.swift` | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ (vision, toolUse)    |
| `ModelQuantization` | `Models/ModelQuantization.swift` | –£—Ä–æ–≤–µ–Ω—å –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏              |
| `ToolCall`          | `Models/ToolCall.swift`          | –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–¥–æ–º–µ–Ω–Ω–∞—è)            |
| `ToolCallResult`    | `Models/ToolCallResult.swift`    | –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞        |
| `ToolDefinition`    | `Models/ToolDefinition.swift`    | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è API         |
| `ToolParameters`    | `Models/ToolParameters.swift`    | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (JSON Schema)     |
| `ToolProperty`      | `Models/ToolProperty.swift`      | –°–≤–æ–π—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞          |
| `ToolCallsResponse` | `Models/ToolCallsResponse.swift` | –û—Ç–≤–µ—Ç —Å –≤—ã–∑–æ–≤–∞–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤           |
| `GenerationStats`   | `Models/GenerationStats.swift`   | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω—ã, —Å–∫–æ—Ä–æ—Å—Ç—å) |

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (Data Flow)

```
User Input
    ‚îÇ
    ‚ñº
ChatViewModel
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚ñ∫ ChatService ‚îÄ‚îÄ‚ñ∫ NetworkService ‚îÄ‚îÄ‚ñ∫ HTTPClient
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    LM Studio API
    ‚îÇ                                    (/api/v1/chat)
    ‚îÇ                                            ‚îÇ
    ‚ñº                                            ‚ñº
SwiftData                                   SSE Stream
(ChatSession ‚óÑ‚îÄ‚îÄ Message)                    ‚îÇ
    ‚ñ≤                                          ‚îÇ
    ‚îÇ                                    SSEParser
    ‚îÇ                                          ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ChatViewModel.updateContent()
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–æ–æ–±—â–µ–Ω–∏—è

```
1. User –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
   ‚îÇ
   ‚ñº
2. ChatViewModel —Å–æ–∑–¥–∞–µ—Ç Message(role: "user")
   ‚îÇ
   ‚ñº
3. ChatService –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/v1/chat
   ‚îÇ
   ‚ñº
4. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç SSE –ø–æ—Ç–æ–∫
   ‚îÇ
   ‚îú‚îÄ‚îÄ‚ñ∫ SSEParser –ø–∞—Ä—Å–∏—Ç —á–∞–Ω–∫–∏
   ‚îÇ
   ‚ñº
5. ChatViewModel —Å–æ–∑–¥–∞–µ—Ç Message(role: "assistant", isGenerating: true)
   ‚îÇ
   ‚ñº
6. –ü—Ä–∏ –∫–∞–∂–¥–æ–º —á–∞–Ω–∫–µ: message.content += chunk
   ‚îÇ
   ‚ñº
7. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ LMDoneEvent: message.isGenerating = false
   ‚îÇ
   ‚ñº
8. SwiftData —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
```

## –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### –≠–∫—Ä–∞–Ω—ã (Views)

| –§–∞–π–ª                     | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è                      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ              |
|--------------------------|---------------------------------|-------------------------|
| `ChatView.swift`         | `Features/Chat/Views/`          | –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —á–∞—Ç–∞      |
| `ChatMessagesView.swift` | `Features/Chat/Views/`          | –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π        |
| `MessageInputView.swift` | `Features/Chat/Views/`          | –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è    |
| `MessageBubble.swift`    | `Features/Chat/Components/`     | –ü—É–∑—ã—Ä—å —Å–æ–æ–±—â–µ–Ω–∏—è        |
| `ShieldView.swift`       | `Features/Chat/Components/`     | 3D —â–∏—Ç –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ–∫–µ–Ω–∞ |
| `HistoryView.swift`      | `Features/History/Views/`       | –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤     |
| `SessionRowView.swift`   | `Features/History/Components/`  | –°—Ç—Ä–æ–∫–∞ —Å–µ—Å—Å–∏–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏ |
| `ModelPicker.swift`      | `Features/Settings/Views/`      | –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏     |
| `ModelRowView.swift`     | `Features/Settings/Components/` | –°—Ç—Ä–æ–∫–∞ –º–æ–¥–µ–ª–∏ –≤ –ø–∏–∫–µ—Ä–µ  |

### ViewModels

| –§–∞–π–ª                  | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è                      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                |
|-----------------------|---------------------------------|-------------------------------------------|
| `ChatViewModel.swift` | `Features/Chat/ViewModels/`     | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º, —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π |
| `AppConfig.swift`     | `Features/Settings/ViewModels/` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Singleton)       |

### –°–µ—Ä–≤–∏—Å—ã (Services)

| –§–∞–π–ª                          | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è          | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                      |
|-------------------------------|---------------------|---------------------------------|
| `ChatService.swift`           | `Services/Chat/`    | –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è API —á–∞—Ç–∞    |
| `ChatSessionManager.swift`    | `Services/Chat/`    | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ SwiftData   |
| `ChatStreamService.swift`     | `Services/Chat/`    | SSE —Å—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤            |
| `NetworkService.swift`        | `Services/Network/` | HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è LM Studio API   |
| `HTTPClient.swift`            | `Services/Network/` | –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π HTTP –∫–ª–∏–µ–Ω—Ç      |
| `SSEParser.swift`             | `Services/Network/` | –ü–∞—Ä—Å–∏–Ω–≥ SSE –ø–æ—Ç–æ–∫–∞              |
| `NetworkMonitor.swift`        | `Services/Network/` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| `AuthorizationProvider.swift` | `Services/Network/` | –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏           |
| `KeychainHelper.swift`        | `Services/Auth/`    | –†–∞–±–æ—Ç–∞ —Å Keychain               |
| `DeviceIdentity.swift`        | `Services/Auth/`    | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞        |

### –ú–æ–¥–µ–ª–∏ (Models)

| –§–∞–π–ª                     | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                     |
|--------------------------|--------------------------------|
| `Message.swift`          | –ú–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è (SwiftData)   |
| `ChatSession.swift`      | –ú–æ–¥–µ–ª—å —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞ (SwiftData) |
| `ModelInfo.swift`        | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏            |
| `LMModelsResponse.swift` | –û—Ç–≤–µ—Ç API —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π       |
| `ToolCall.swift`         | –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞              |
| `GenerationStats.swift`  | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏           |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –§–∞–π–ª                                                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                           |
|-----------------------------------------------------|--------------------------------------|
| `project.yml`                                       | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è XcodeGen                |
| `swiftgen.yml`                                      | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SwiftGen                |
| `.swiftlint.yml`                                    | –ü—Ä–∞–≤–∏–ª–∞ SwiftLint                    |
| `GUIDELINES.md`                                     | –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ     |
| `IMPROVEMENT_PLAN.md`                               | –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π                       |
| `VERSIONING.md`                                     | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏                  |
| `Tools/Scripts/Sources/Scripts/Core/Versions.swift` | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ |

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Xcode 15.0+
- XcodeGen 2.44.1
- SwiftGen 6.6.3
- SwiftLint 0.63.2
- Swift 6.0

### –ö–æ–º–∞–Ω–¥—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `swift run scripts`)

| –ö–æ–º–∞–Ω–¥–∞                           | –û–ø–∏—Å–∞–Ω–∏–µ                                              |
|-----------------------------------|-------------------------------------------------------|
| `swift run scripts setup`         | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Xcode (XcodeGen + SwiftGen)         |
| `swift run scripts check`         | –õ–∏–Ω—Ç–∏–Ω–≥, —Å–±–æ—Ä–∫–∞, —Ç–µ—Å—Ç—ã, –ø–æ–∫—Ä—ã—Ç–∏–µ 100%, –∫–æ–º–º–∏—Ç + –ø—É—à   |
| `swift run scripts ship`          | Release-—Å–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Saint Celestine |
| `swift run scripts download-docs` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API                 |

### Workflow

**Check** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º push):

- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç (XcodeGen + SwiftGen)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∏–ª—å –∫–æ–¥–∞ (SwiftLint)
- –°–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã (xcodebuild test)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ (100%)
- –ö–æ–º–º–∏—Ç–∏—Ç –∏ –ø—É—à–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**Ship** (–¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ):

- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ: `swift run scripts check` –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏
- –°–æ–±–∏—Ä–∞–µ—Ç –≤ Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å code signing
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Saint Celestine
- –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π sudo (`swift run scripts configure-sudo`)

## –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –°—Ç–∏–ª—å –∫–æ–¥–∞

- **–Ø–∑—ã–∫**: –†—É—Å—Å–∫–∏–π (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤)
- **SwiftLint**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 160 —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ, —Ç—Ä–µ–±—É–µ—Ç `@MainActor` –Ω–∞ ViewModel
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –º–æ–¥—É–ª—è–º —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- **Unit-—Ç–µ—Å—Ç—ã**: –§—Ä–µ–π–º–≤–æ—Ä–∫ Swift Testing —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º AAA
- **UI-—Ç–µ—Å—Ç—ã**: –ü–∞—Ç—Ç–µ—Ä–Ω Page Object Model –≤ `ChatUITests/Pages/`
- **–°–Ω–∞–ø—à–æ—Ç—ã**: SnapshotTesting –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**: –¶–µ–ª—å ‚Äî 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

### –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è

- ViewModels: `*ViewModel.swift` —Å `@MainActor`
- Views: `*View.swift`
- Services: `*Service.swift`, `*Manager.swift`
- Models: PascalCase (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Message`, `ChatSession`)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã

- **Colors**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `AppColors`, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ `Color.`
- **Spacing**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `AppSpacing`, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤ `.padding()`
- **Typography**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `AppTypography`
- –§–∞–π–ª—ã: `Design/Typography.swift`, `Design/Spacing.swift`, `Design/Colors.swift`

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Keychain
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ API —Ç—Ä–µ–±—É—é—Ç Docstrings –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –í –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `// MARK: - –°–≤—è–∑—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π:`

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Injected` –∏–∑ Factory
2. **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–µ—Ä–≤–∏—Å—ã –∏–º–µ—é—Ç —É–∑–∫—É—é, —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
3. **–ü–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –º–æ–¥—É–ª—è–º**: –ö–æ–¥ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø–æ —Ñ–∏—á–∞–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
4. **AuthorizationProvider**: –í—Å—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

## –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µÊµÅÁ®ã

#### –û–±—ã—á–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
2. –î–µ–ª–∞—é —Ä–∞–±–æ—Ç—É —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
3. –ó–∞–ø—É—Å–∫–∞—é swift run scripts check
4. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ ‚Üí –ø—Ä–æ—à—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (—Ñ–æ—Ä–º–∞—Ç –Ω–∏–∂–µ)
5. –ï—Å–ª–∏ check –ø—Ä–æ—à—ë–ª ‚Üí –∫–æ–º–º–∏—Ç –∏ –ø—É—à –≤ —Å–∫—Ä–∏–ø—Ç–µ ‚Üí —Ä–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

#### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ UI (–≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã)

```
1. –¢–æ –∂–µ —á—Ç–æ –≤—ã—à–µ
2. –ó–∞–ø—É—Å–∫–∞—é swift run scripts ship
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
4. –†–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

**–ü–æ—Å–ª–µ ship ‚Äî –∫–æ—Ä–æ—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞:**

- –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –ö—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å (—ç–∫—Ä–∞–Ω, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
- –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–ø–æ—à–∞–≥–æ–≤–æ)

### –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ check

1. **–°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞—é—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å** –≤—Å–µ–º–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
2. –ï—Å–ª–∏ **—Å–æ–≤—Å–µ–º –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è** –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚Äî –ø—Ä–æ—à—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å

**–§–æ—Ä–º–∞—Ç –≤–æ–ø—Ä–æ—Å–∞:**

```
–ú–æ–∂–Ω–æ —è –±—É–¥—É –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É: –¢–ï–ö–°–¢_–û–®–ò–ë–ö–ò?
```

–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ "–¥–∞" –∏–ª–∏ "–º–æ–∂–Ω–æ" ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞—é.

### Git-—Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

- **–û–¥–∏–Ω –∫–æ–º–º–∏—Ç –≤ –≤–µ—Ç–∫–µ**: –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `git commit --amend`
- **Rebase** –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Ä–µ–ª–∏–∑–Ω—É—é –≤–µ—Ç–∫—É –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
- **Force push**: `git push --force-with-lease` –¥–ª—è amended –∫–æ–º–º–∏—Ç–æ–≤
- **–°–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤**: –ù–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –æ–ø–∏—Å—ã–≤–∞—é—Ç "–ø–æ—á–µ–º—É", –∞ –Ω–µ "—á—Ç–æ"

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏

–ü—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞, –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å:

1. `.junie/context.json` ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
2. `GUIDELINES.md` ‚Äî –æ–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
3. `.junie/instructions.md` ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å ‚Äî –∑–∞–ª–æ–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Factory** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏. –í—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ `Core/Container+Registrations.swift`:

```swift
@MainActor
extension Container {
    var sessionManager: Factory<ChatSessionManager> {
        ...
    }
.singleton
    var networkService: Factory<NetworkService> {
        ...
    }
.singleton
    var chatService: Factory<ChatService> {
        ...
    }
.singleton
    var networkMonitor: Factory<NetworkMonitor> {
        ...
    }
.singleton
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:

```swift
@Injected(\.sessionManager) private var sessionManager
@Injected(\.chatService) private var chatService
```

### Concurrency (async/await)

- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ–º–µ—á–µ–Ω—ã `@MainActor` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å UI
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Swift Concurrency: `async`, `await`, `Task`
- `AsyncThrowingStream` –¥–ª—è SSE —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- `Combine` –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ `NetworkMonitor`

### –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

**SwiftData** —á–µ—Ä–µ–∑ `PersistenceController` (`Data/PersistenceController.swift`):

- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: `container.mainContext`
- –°—Ö–µ–º–∞: `[ChatSession.self, Message.self]`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ in-memory —Ä–µ–∂–∏–º–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –ú–µ—Ç–æ–¥—ã: `save()`, `deleteAll()`

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

**Keychain** —á–µ—Ä–µ–∑ `KeychainHelper` (`Services/Auth/KeychainHelper.swift`):

- –•—Ä–∞–Ω–µ–Ω–∏–µ API —Ç–æ–∫–µ–Ω–æ–≤
- –£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞: `kSecAttrAccessibleWhenUnlockedThisDeviceOnly`
- –ú–µ—Ç–æ–¥—ã: `get(key:)`, `set(key:value:)`, `delete(key:)`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –¢–∏–ø            | –§–∞–π–ª                                 | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                |
|----------------|--------------------------------------|-----------------------------------------------------------------------------------------|
| `NetworkError` | `Services/Errors/NetworkError.swift` | invalidURL, noData, decodingError, serverError, unauthorized, rateLimited, networkError |
| `AuthError`    | `Services/Errors/AuthError.swift`    | –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏                                                                   |

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**Pulse** (`Services/NetworkConfiguration.swift`):

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `URLSessionProxyDelegate()`
- –í—ã–∑–æ–≤ –∫–æ–Ω—Å–æ–ª–∏: –¥–≤–æ–π–Ω–æ–π —Ç–∞–ø –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É "Chat" (ChatView.swift:162)
- `import Pulse` –≤ NetworkConfiguration
- `import PulseUI` –≤ ChatView –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ConsoleView

–õ–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤: –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `Logs/Check/`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

| Test Plan | –§–∞–π–ª                             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                            |
|-----------|----------------------------------|---------------------------------------|
| UnitTests | `TestPlans/UnitTests.xctestplan` | Unit —Ç–µ—Å—Ç—ã (Swift Testing)            |
| UITests   | `TestPlans/UITests.xctestplan`   | UI —Ç–µ—Å—Ç—ã (XCTest + Page Object Model) |
| AllTests  | `TestPlans/AllTests.xctestplan`  | –í—Å–µ —Ç–µ—Å—Ç—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–µ–π           |

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Swift Scripts)

Swift-based CLI –≤ `Tools/Scripts/` (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ `Scripts.swift`):

| –ö–æ–º–∞–Ω–¥–∞         | –§–∞–π–ª                             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                           |
|-----------------|----------------------------------|--------------------------------------|
| Setup           | `Commands/Setup.swift`           | XcodeGen + SwiftGen –≥–µ–Ω–µ—Ä–∞—Ü–∏—è        |
| Check           | `Commands/Check.swift`           | SwiftLint + —Ç–µ—Å—Ç—ã + —Å–±–æ—Ä–∫–∞ (default) |
| Ship            | `Commands/Ship.swift`            | Release —Å–±–æ—Ä–∫–∞ + –¥–µ–ø–ª–æ–π              |
| DownloadDocs    | `Commands/DownloadDocs.swift`    | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏              |
| UpdateDocsLinks | `Commands/UpdateDocsLinks.swift` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é    |
| ConfigureSudo   | `Commands/ConfigureSudo.swift`   | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ—Å–ø–∞—Ä–æ–ª—å–Ω–æ–≥–æ sudo         |

–ó–∞–ø—É—Å–∫: `./scripts <command>`

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ –≤ `Tools/Scripts/Sources/Scripts/Core/Versions.swift`:

- XcodeGen, SwiftGen, SwiftLint
- SPM –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: Factory, Pulse, SnapshotTesting
- iOS Deployment Target, Swift version

### –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç      | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                       |
|----------------|-------------------------|----------------------------------|
| LM Studio      | REST API v1             | –õ–æ–∫–∞–ª—å–Ω—ã–π LLM —Å–µ—Ä–≤–µ—Ä (–æ—Å–Ω–æ–≤–Ω–æ–π)  |
| Apple Keychain | Security framework      | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤      |
| Pulse          | URLSessionProxyDelegate | –°–µ—Ç–µ–≤–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| NWPathMonitor  | Network framework       | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ç–∏          |

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–∞–∫–∂–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –¥–ª—è Ollama (_docs), –Ω–æ runtime-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–µ—Ç.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è iOS-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- **Personal Team**: –ë–µ–∑ CloudKit, Push Notifications, IAP, Apple Pay
- **Code Signing**: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–≤
- **–¶–µ–ª–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ**: ¬´Saint Celestine¬ª (—Ä–µ–∞–ª—å–Ω—ã–π iPhone)

## Qwen Added Memories
- –î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ (check, setup, ship) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mcp__idea__execute_terminal_command —Å –∫–æ–º–∞–Ω–¥–æ–π xcodebuild
  -scheme "üîç Check" build && <path_to_scripts_binary> check
- Do not change linting rules - keep .swiftlint.yml as is without modifications
